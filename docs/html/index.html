<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arduino live555: Arduino LIVE555 Streaming Media</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arduino live555
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Arduino LIVE555 Streaming Media </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="http://www.live555.com/">LIVE555</a> is a set of open source (LGPL) C++ libraries developed by Live Networks, Inc. for multimedia streaming. The libraries support open standards such as RTP/RTCP and RTSP for streaming, and can also manage video RTP payload formats such as MPEG, AAC, AMR, AC-3 and Vorbis.</p>
<p>It is used internally by well-known software such as VLC and mplayer.</p>
<p>In order to make the library available for Arduino I have</p>
<ul>
<li>Created the src directory with symlinks to all source files</li>
<li>Deactivated exceptions (with the help of #defines)</li>
<li>Used lwip as network interface</li>
<li>Replaced printf(stderr, ...) with a separate LOG() method, so that we can handle them properly in Arduino</li>
<li>Renamed inet.c to inet.cpp so that we can use c++ classes</li>
<li>Applied plenty of additional corrections, so that the library runs on an Arduino-ESP32</li>
<li>Used a <a href="https://pschatzmann.github.io/live555/html/class_abstract_file.html#details">file abstraction layer</a> to replace the stdio.h operations so that we can use different SD libraries</li>
</ul>
<p>The biggest challenge was with the last point. Unfortunately Arduino does not provide a proper stdio.h implementation that can be used to access files. On the other hand most projects assume that stdio.h is available and therfore do not use any additional abstraction layer: live555 is here not an exception.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Use Cases</h2>
<ul>
<li>Stream Audio or Video from a Microcontroller and play it e.g. with the help of the VLC Player</li>
<li>Stream Audio or Video to a Microcontroller</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Example Sketch</h2>
<p>I have also created a simple mp3 streaming API. Here is an example that uses the <a href="https://github.com/greiman/SdFat">SdFat library</a> from Bill Greiman to access the files on a SD card:</p>
<div class="fragment"><div class="line">#include &quot;FileAccessSdFat.hh&quot;</div>
<div class="line">#include &quot;SimpleStreamer.hh&quot;</div>
<div class="line"> </div>
<div class="line">SimpleMP3Streamer mp3(new FileAccessSdFat());</div>
<div class="line"> </div>
<div class="line">void setup() {</div>
<div class="line">  Serial.begin(115200);</div>
<div class="line"> </div>
<div class="line">  auto cfg = mp3.defaultConfig();</div>
<div class="line">  cfg.destinationAddress = &quot;192.168.1.255&quot;;</div>
<div class="line">  cfg.filePath = &quot;/Music/Conquistadores.mp3&quot;;</div>
<div class="line">  cfg.isAutoRestart = true;</div>
<div class="line">  cfg.ssid = &quot;SSID&quot;;</div>
<div class="line">  cfg.password = &quot;password&quot;;</div>
<div class="line"> </div>
<div class="line">  if (mp3.begin(cfg)){</div>
<div class="line">    mp3.play();</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">void loop() {</div>
<div class="line">  mp3.singleStep();</div>
<div class="line">}</div>
</div><!-- fragment --><p> In the constructor of the <a href="https://pschatzmann.github.io/live555/html/class_simple_m_p3_streamer.html">SimpleMP3Streamer</a> we need to indicate the file access class. For starting the streaming we need to provide <b>a file</b> and <b>the destination ip</b> address: <code>192.168.1.255</code> is a broadcast address. This is done with the help of the <a href="https://pschatzmann.github.io/live555/html/struct_simple_streamer_config.html">SimpleStreamerConfig</a>. If we did not start the network yet we need to provide the ssid and password. The <code>cfg.isAutoRestart = true;</code> is making shure that when the end of the file is reached that we restart again. I also provide the afterPlayingCallback method which can be used to select a new file and "restart playing"...</p>
<h2><a class="anchor" id="autotoc_md3"></a>
VLC Player</h2>
<p>The VLC Player can be used to receive the streamed music. Just use -&gt; File -&gt; Open Network and enter the <code>udp://@:6666</code> address.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Class Documentation</h2>
<p>Here is the <a href="https://pschatzmann.github.io/live555/html/classes.html">generated class documentation</a></p>
<h2><a class="anchor" id="autotoc_md5"></a>
Project Status</h2>
<p>I am really struggeling to make this work. The sound is breaking up and I did not find so far what is causing this.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Installation</h2>
<p>For Arduino you can download the library as zip and call include Library -&gt; zip library. Or you can git clone this project into the Arduino libraries folder e.g. with</p>
<div class="fragment"><div class="line">cd  ~/Documents/Arduino/libraries</div>
<div class="line">git clone pschatzmann/live555.git</div>
</div><!-- fragment --><p>I recommend to use the git method, so that you can simply get updates by executing the <code>git pull</code> command in the live555 library folder.</p>
<p>For building and running the code on your desktop, please consult the original <a href="https://github.com/pschatzmann/live555/blob/master/BUILD.md">build instructions</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
